{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Anomali Limo Threat Intel Feed - 1.0.0",
      "description": "Sample playbooks for \"Anomali Limo Threat Intel Feed\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "medium.png",
      "uuid": "bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
      "id": 72,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1641389082,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1641389082,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Anomali Limo > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Collections from Anomali Limo",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1639399462,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/23ec15dc-a06d-4605-a7ef-826ddbb72186",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "23ec15dc-a06d-4605-a7ef-826ddbb72186",
              "id": 3796
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.pullTimeMacro}}",
                  "value": "{{vars.fetchTime}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "2f0d6448-9605-42a6-98a2-49c2e7446017",
              "id": 3797
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Value from Response",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.get(arrow.utcnow()).shift(days=-30).int_timestamp}}\n{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "40d75fe1-b53e-43aa-a999-31deac847222",
              "id": 3798
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.utcnow().int_timestamp}}",
                "pullTimeMacro": "AnomaliLimoFeedLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "57259abd-dc1d-4cec-96f5-7afa676ced25",
              "id": 3799
            },
            {
              "@type": "WorkflowStep",
              "name": "Ingest records for Each Collection",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{ vars.steps.Get_All_Collections.data.collections }}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "collectionID": "{{vars.item.id}}",
                  "lastPullTime": "{{vars.lastPullTime}}"
                },
                "apply_async": true,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/ad56312d-d87d-4988-a40a-bbb6a7aa2a6d"
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "a0942fac-f209-4577-a44c-b58941b88fdf",
              "id": 3800
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Collections",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "505b9598-9936-4351-abe9-ee1cef696bb5",
                "params": [],
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "a6655285-dbee-4837-aa38-e8c7f2c5a309",
              "id": 3801
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b1c3cf0d-1c6c-4214-900e-9651aa044910",
              "id": 3802
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value from Response -> Get All Collections",
              "targetStep": "/api/3/workflow_steps/a6655285-dbee-4837-aa38-e8c7f2c5a309",
              "sourceStep": "/api/3/workflow_steps/40d75fe1-b53e-43aa-a999-31deac847222",
              "label": null,
              "isExecuted": false,
              "uuid": "172baa04-4849-4b8b-9cd5-4b01726bd633"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Ingest records for each collection -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/2f0d6448-9605-42a6-98a2-49c2e7446017",
              "sourceStep": "/api/3/workflow_steps/a0942fac-f209-4577-a44c-b58941b88fdf",
              "label": null,
              "isExecuted": false,
              "uuid": "7cefdeb8-202c-45d5-91f1-cca4b38afc2b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/b1c3cf0d-1c6c-4214-900e-9651aa044910",
              "sourceStep": "/api/3/workflow_steps/57259abd-dc1d-4cec-96f5-7afa676ced25",
              "label": null,
              "isExecuted": false,
              "uuid": "8bc9082e-b8c4-4bf4-8309-1a7be40f577d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value from Response",
              "targetStep": "/api/3/workflow_steps/40d75fe1-b53e-43aa-a999-31deac847222",
              "sourceStep": "/api/3/workflow_steps/b1c3cf0d-1c6c-4214-900e-9651aa044910",
              "label": null,
              "isExecuted": false,
              "uuid": "c1a3fad3-d2fe-4789-aaca-354f573a93ea"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Collections -> Ingest records for each collection",
              "targetStep": "/api/3/workflow_steps/a0942fac-f209-4577-a44c-b58941b88fdf",
              "sourceStep": "/api/3/workflow_steps/a6655285-dbee-4837-aa38-e8c7f2c5a309",
              "label": null,
              "isExecuted": false,
              "uuid": "d4f40dcf-1fc5-48b5-84bb-77b850bad225"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/57259abd-dc1d-4cec-96f5-7afa676ced25",
              "sourceStep": "/api/3/workflow_steps/23ec15dc-a06d-4605-a7ef-826ddbb72186",
              "label": null,
              "isExecuted": false,
              "uuid": "e32ebaef-55b9-4060-b363-f01636001d6d"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "34af6158-dc2d-4931-8e6b-88ae40ea32bf",
          "recordTags": [
            "dataingestion",
            "ingest",
            "anomali-limo-threat-intel-feed"
          ],
          "id": 685,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1641389082,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Object By Object ID",
          "aliasName": null,
          "tag": "#Anomali Limo Threat Intel Feed",
          "description": "Returns general information for the specific object of a collection.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641400731,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/968f5f37-700a-44a3-b6cc-4acfb0a4fe34",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "6c62c5cd-2929-436c-9b73-314c4f270b88",
                "title": "Anomali Limo Threat Intel Feed: Get Object By Object ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "968f5f37-700a-44a3-b6cc-4acfb0a4fe34",
              "id": 3803
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Object By Object ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "a0ffc0e0-fafd-46b4-a518-a8069d8c0bfd",
                "params": {
                  "objectID": "indicator--47744418-8707-46da-8df3-77a980b7f446",
                  "collectionID": "107"
                },
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_objects_by_object_id",
                "operationTitle": "Get Object By Object ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b0faa69c-494d-40b1-9fa3-0dbd92b1f108",
              "id": 3804
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Object By Object ID",
              "targetStep": "/api/3/workflow_steps/b0faa69c-494d-40b1-9fa3-0dbd92b1f108",
              "sourceStep": "/api/3/workflow_steps/968f5f37-700a-44a3-b6cc-4acfb0a4fe34",
              "label": null,
              "isExecuted": false,
              "uuid": "3bc5a41d-a930-4c41-a27d-cbed832644ee"
            }
          ],
          "priority": null,
          "uuid": "55e2c275-16fd-4880-8782-db5d4fdd00d9",
          "recordTags": [
            "anomali-limo-threat-intel-feed"
          ],
          "id": 686,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641400730,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Objects By Collection ID",
          "aliasName": null,
          "tag": "#Anomali Limo Threat Intel Feed",
          "description": "Retrieve all available objects in a Collection.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641400751,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5a9ddc88-fb69-4143-9077-c32363085b51",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Objects By Collection ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "''",
                "params": {
                  "limit": "",
                  "offset": "0",
                  "added_after": "",
                  "collectionID": "",
                  "file_response": true
                },
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2aec2a2e-c037-4a38-8b7d-cbd001b55d69",
              "id": 3805
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "951dd9b9-ce19-430f-b686-bdcd68aed2f6",
                "title": "Anomali Limo Threat Intel Feed: Get Objects By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "5a9ddc88-fb69-4143-9077-c32363085b51",
              "id": 3806
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Objects By Collection ID",
              "targetStep": "/api/3/workflow_steps/2aec2a2e-c037-4a38-8b7d-cbd001b55d69",
              "sourceStep": "/api/3/workflow_steps/5a9ddc88-fb69-4143-9077-c32363085b51",
              "label": null,
              "isExecuted": false,
              "uuid": "61933709-527d-41c9-a0d1-68506a2070ac"
            }
          ],
          "priority": null,
          "uuid": "61815047-9935-4a4d-bc49-6ed828ea7483",
          "recordTags": [
            "anomali-limo-threat-intel-feed"
          ],
          "id": 687,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641400750,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Manifest By Collection ID",
          "aliasName": null,
          "tag": "#Anomali Limo Threat Intel Feed",
          "description": "Returns manifest information about all available objects.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641400712,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/960304c8-ea92-4e53-9192-edf26bafaf14",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "862d7625-6301-4c83-a660-34b552f6751f",
                "title": "Anomali Limo Threat Intel Feed: Get Manifest By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "960304c8-ea92-4e53-9192-edf26bafaf14",
              "id": 3807
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Manifest By Collection ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "a0ffc0e0-fafd-46b4-a518-a8069d8c0bfd",
                "params": {
                  "added_after": "",
                  "collectionID": "107"
                },
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_manifest_by_collection_id",
                "operationTitle": "Get Manifest By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ad7a74fd-9f77-4a2d-9987-ab7dedfcfe26",
              "id": 3808
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Manifest By Collection ID",
              "targetStep": "/api/3/workflow_steps/ad7a74fd-9f77-4a2d-9987-ab7dedfcfe26",
              "sourceStep": "/api/3/workflow_steps/960304c8-ea92-4e53-9192-edf26bafaf14",
              "label": null,
              "isExecuted": false,
              "uuid": "b1cad803-cbb6-4c40-ae7b-be947844a8e8"
            }
          ],
          "priority": null,
          "uuid": "752d70c1-9e1c-46f3-92a5-d046ad9489cb",
          "recordTags": [
            "anomali-limo-threat-intel-feed"
          ],
          "id": 688,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641400712,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get API Root Information",
          "aliasName": null,
          "tag": "#Anomali Limo Threat Intel Feed",
          "description": "Returns information contains title, description, TAXII versions and maximum size of the content body for the specified TAXII server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641400672,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ebc668dd-9218-4872-bc11-2d5154367009",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get API Root Information",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_api_root_information",
                "operationTitle": "Get API Root Information",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "0ff80d2e-02e8-4f30-8a04-267bee12fb3c",
              "id": 3809
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "e61a1e2b-efa2-4d5a-8e90-3436e74ae21f",
                "title": "Anomali Limo Threat Intel Feed: Get API Root Information",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "ebc668dd-9218-4872-bc11-2d5154367009",
              "id": 3810
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get API Root Information",
              "targetStep": "/api/3/workflow_steps/0ff80d2e-02e8-4f30-8a04-267bee12fb3c",
              "sourceStep": "/api/3/workflow_steps/ebc668dd-9218-4872-bc11-2d5154367009",
              "label": null,
              "isExecuted": false,
              "uuid": "ed263e31-99c5-49c1-8654-a4d37d8189ad"
            }
          ],
          "priority": null,
          "uuid": "855b8b4d-1442-49a9-adae-fb453ccc8d30",
          "recordTags": [
            "anomali-limo-threat-intel-feed"
          ],
          "id": 689,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641400671,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Collections",
          "aliasName": null,
          "tag": "#Anomali Limo Threat Intel Feed",
          "description": "Returns the list of public/private/shared collection resources to which the user has access.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641400694,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ce8d9e99-1cde-443a-ad3e-eaf43bc6cdd0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Collections",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "a0ffc0e0-fafd-46b4-a518-a8069d8c0bfd",
                "params": {
                  "collectionID": "107"
                },
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6cd57a3b-2e2e-4d31-bd2c-d834598d5ba9",
              "id": 3811
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "5042450c-b961-4b00-b8dd-1b901a13571d",
                "title": "Anomali Limo Threat Intel Feed: Get Collections",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "ce8d9e99-1cde-443a-ad3e-eaf43bc6cdd0",
              "id": 3812
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Collections",
              "targetStep": "/api/3/workflow_steps/6cd57a3b-2e2e-4d31-bd2c-d834598d5ba9",
              "sourceStep": "/api/3/workflow_steps/ce8d9e99-1cde-443a-ad3e-eaf43bc6cdd0",
              "label": null,
              "isExecuted": false,
              "uuid": "787249a1-7b05-46b6-8f34-f2102699a935"
            }
          ],
          "priority": null,
          "uuid": "9323b23a-a785-4b30-9043-5176642e0735",
          "recordTags": [
            "anomali-limo-threat-intel-feed"
          ],
          "id": 690,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641400694,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Anomali Limo > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": "Fetch and Create Indicator from Anomali Limo",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "collectionID",
            "lastPullTime"
          ],
          "synchronous": false,
          "lastModifyDate": 1641401114,
          "collection": "/api/3/workflow_collections/bd186ecd-ad4a-4910-a1ff-6e4d762d3ae6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/be1ac484-aa21-493c-bbf6-e3c5c65c4a9a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Objects_For_Collection.data}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 1000
                },
                "resource": {
                  "tlp": "{{vars.tlp_resolve_range}}",
                  "value": "{%if ':value' in vars.item.pattern %}{{ vars.item.pattern.split(\":value = \")[-1].split(\"]\")[0].strip()[1:-1] }}{% elif 'network-traffic' in vars.item.pattern %}{{ vars.item.pattern.split(\"network-traffic:src_ref.value =\")[-1].split(\"]\")[0].strip()[1:-1] + \":\" + vars.item.pattern.split(\"network-traffic:src_port =\")[1].split(\"AND\")[0].strip()}}{% else %}Malicious Feed{% endif %}",
                  "sourceID": "{{vars.item.objects[0].id}}",
                  "__replace": "true",
                  "firstSeen": "{{(arrow.get(vars.item['created']).int_timestamp)}}",
                  "reputation": "{{vars.reputation_resolve_range}}",
                  "description": "<p>{{ vars.item.description }}\nReputation: {{vars.item.labels}}\n</p>",
                  "indicatorStatus": {
                    "id": 39,
                    "@id": "/api/3/picklists/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "icon": null,
                    "uuid": "2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "@type": "Picklist",
                    "color": null,
                    "display": "TBD",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "typeofindicator": "{{(vars.item['pattern'].split('=')[0].split('[')[-1].strip().replace(':','-')) | resolveRange(vars.indicators_typeofindicator_map)}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "1260",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "3d2017cb-50b2-44d4-b8f1-06e3b98c2c6b",
              "id": 3813
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "[\n            {\n                \"created\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"created_by_ref\": \"identity--77138c7e-d23e-4966-922c-578c5793e82c\",\n                \"id\": \"indicator--8f21728d-6206-4cb7-9248-fb05c4ecfc9a\",\n                \"indicator_types\": [\n                    \"domain-watchlist\"\n                ],\n                \"modified\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"name\": \"Malicious domains\",\n                \"pattern\": \"[url:value = 'trumphujtebevrot.bit']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            },\n            {\n                \"created\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"created_by_ref\": \"identity--77138c7e-d23e-4966-922c-578c5793e82c\",\n                \"id\": \"indicator--bef17ec9-ac57-482e-9b50-32023c50a728\",\n                \"indicator_types\": [\n                    \"url-watchlist\"\n                ],\n                \"modified\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"name\": \"Malicious URLs\",\n                \"pattern\": \"[url:value = 'http://dood.to/d/8djq6xhrqx31']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            },\n            {\n                \"created\": \"2021-08-19T07:06:55.546999+00:00\",\n                \"id\": \"indicator--6f159a90-752e-4e6b-bebb-28e03c62c175\",\n                \"indicator_types\": [\n                    \"malicious-activity\"\n                ],\n                \"modified\": \"2021-08-19T07:06:55.546999+00:00\",\n                \"name\": \"ZeroAccess\",\n                \"pattern\": \"[network-traffic:src_port = 16464 AND network-traffic:src_ref.value = '24.45.106.57']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            }\n]"
              },
              "status": null,
              "top": "220",
              "left": "940",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3f7d9422-f20f-409d-b770-2be392560b37",
              "id": 3814
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "Red",
                "expiry": "90",
                "tlp_map": "{'Red': {{'TrafficLightProtocol'| picklist('Red') }}, 'Amber': {{'TrafficLightProtocol'| picklist('Amber') }}, 'Green': {{'TrafficLightProtocol'| picklist('Green') }}, 'White': {{'TrafficLightProtocol'| picklist('White') }}}",
                "confidence": "50",
                "reputation": "Malicious",
                "reputation_map": "{'Good': {{'IndicatorReputation'| picklist('Good') }}, 'Malicious': {{'IndicatorReputation'| picklist('Malicious') }}, 'Suspicious': {{'IndicatorReputation'| picklist('Suspicious') }}, 'TBD': {{'IndicatorReputation'| picklist('TBD') }}, 'No Reputation Available': {{'IndicatorReputation'| picklist('No Reputation Available') }}}",
                "indicators_indicatorStatus_map": "{}",
                "indicators_typeofindicator_map": "{'domain-name-value': {{'IndicatorType'| picklist('Domain') }}, 'file-name': {{'IndicatorType'| picklist('File') }}, 'file-hashes.md5': {{'IndicatorType'| picklist('FileHash-MD5') }}, 'file-hashes.sha1': {{'IndicatorType'| picklist('FileHash-SHA1') }}, 'file-hashes.sha256': {{'IndicatorType'| picklist('FileHash-SHA256') }}, 'network-traffic, ipv4-addr-value, ipv6-addr-value': {{'IndicatorType'| picklist('IP Address') }}, 'windows-registry-key-key': {{'IndicatorType'| picklist('Registry') }}, 'process-name': {{'IndicatorType'| picklist('Process') }}, 'url-value': {{'IndicatorType'| picklist('URL') }}}"
              },
              "status": null,
              "top": "160",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "804ff0f8-37e6-4a55-86aa-91ee2931762e",
              "id": 3815
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "tlp_resolve_range": "{{vars.tlp | resolveRange(vars.tlp_map)}}",
                "reputation_resolve_range": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
              },
              "status": null,
              "top": "260",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "8305efc5-5dc0-4545-8efb-d4679d12876d",
              "id": 3816
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Data Only For Mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/3f7d9422-f20f-409d-b770-2be392560b37",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Return Sample Data"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/b1832951-18cb-49b6-a8ae-c7d3970c652e",
                    "step_name": "Get Objects For Collection"
                  }
                ]
              },
              "status": null,
              "top": "380",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "a0d097d7-8370-4fa0-9723-7cfb3a684346",
              "id": 3817
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Objects For Collection",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "505b9598-9936-4351-abe9-ee1cef696bb5",
                "params": {
                  "limit": "",
                  "offset": "0",
                  "added_after": "{{vars.input.params.lastPullTime}}",
                  "output_mode": "Return as a JSON",
                  "collectionID": "{{vars.input.params.collectionID}}"
                },
                "version": "1.0.0",
                "connector": "anomali-limo-threat-intel-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "940",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b1832951-18cb-49b6-a8ae-c7d3970c652e",
              "id": 3818
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n  {\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true\n  }\n]"
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "be1ac484-aa21-493c-bbf6-e3c5c65c4a9a",
              "id": 3819
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Return Sample Data",
              "targetStep": "/api/3/workflow_steps/3f7d9422-f20f-409d-b770-2be392560b37",
              "sourceStep": "/api/3/workflow_steps/a0d097d7-8370-4fa0-9723-7cfb3a684346",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "uuid": "31ddddd8-4ec1-486f-b057-da4f388946bc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> Is Data Only For Mapping",
              "targetStep": "/api/3/workflow_steps/a0d097d7-8370-4fa0-9723-7cfb3a684346",
              "sourceStep": "/api/3/workflow_steps/8305efc5-5dc0-4545-8efb-d4679d12876d",
              "label": null,
              "isExecuted": false,
              "uuid": "6ba582c2-6921-47c4-a510-595471192d29"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/8305efc5-5dc0-4545-8efb-d4679d12876d",
              "sourceStep": "/api/3/workflow_steps/804ff0f8-37e6-4a55-86aa-91ee2931762e",
              "label": null,
              "isExecuted": false,
              "uuid": "ae4ff06f-05e3-44d8-800d-63771986b0a2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/804ff0f8-37e6-4a55-86aa-91ee2931762e",
              "sourceStep": "/api/3/workflow_steps/be1ac484-aa21-493c-bbf6-e3c5c65c4a9a",
              "label": null,
              "isExecuted": false,
              "uuid": "b4b84b40-2b16-4b17-ab4c-f302e300a967"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Objects For Collection -> Create Record",
              "targetStep": "/api/3/workflow_steps/3d2017cb-50b2-44d4-b8f1-06e3b98c2c6b",
              "sourceStep": "/api/3/workflow_steps/b1832951-18cb-49b6-a8ae-c7d3970c652e",
              "label": null,
              "isExecuted": false,
              "uuid": "ddc77051-e5ff-434c-98e8-89511b5a4810"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Get Objects For Collection",
              "targetStep": "/api/3/workflow_steps/b1832951-18cb-49b6-a8ae-c7d3970c652e",
              "sourceStep": "/api/3/workflow_steps/a0d097d7-8370-4fa0-9723-7cfb3a684346",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "uuid": "e57ae38e-e470-4fd2-af22-6c4be69887ea"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ad56312d-d87d-4988-a40a-bbb6a7aa2a6d",
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "anomali-limo-threat-intel-feed"
          ],
          "id": 691,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1641389082,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641401116,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "exported_tags": [
    "dataingestion",
    "ingest",
    "anomali-limo-threat-intel-feed",
    "create",
    "fetch"
  ]
}
