{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Anomali Limo Threat Intel Feed - 1.0.0",
      "description": "Sample playbooks for \"Anomali Limo Threat Intel Feed\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/3426fc90-313b-4006-9728-68139681d1cc",
      "uuid": "1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
      "id": 103,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1638342537.971057,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1638342537.971057,
      "recordTags": [],
      "deletedAt": null,
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Anomali Limo > Ingest",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638363973,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/99b0d430-0dfe-426e-af5a-f726d0d25120",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "99b0d430-0dfe-426e-af5a-f726d0d25120",
              "id": 4964
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.utcnow().int_timestamp}}",
                "pullTimeMacro": "AnomaliLimoFeedLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "0cfd2cff-194a-4049-9106-03bf98e15c3a",
              "id": 4966
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.pullTimeMacro}}",
                  "value": "{{vars.fetchTime}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "4e0f6122-d74f-44f4-bbc9-2768ba1fe041",
              "id": 4967
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "1339cda3-f5b8-4b98-b5ec-1020aea1b46f",
              "id": 4968
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Value from Response",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}0{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5333a1e5-fbf3-4877-ac8d-16245e7cb47c",
              "id": 4969
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Collections",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "6d970bd1-c888-467d-8748-80a814fafbdf",
                "params": [],
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "0de3f730-3333-48a6-b1ac-d7cf2967c5fc",
              "id": 4970
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch and Create",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "6d970bd1-c888-467d-8748-80a814fafbdf",
                "params": {
                  "limit": "",
                  "offset": "0",
                  "added_after": "{{vars.lastPullTime}}",
                  "output_mode": "Create as Feed Records in FortiSOAR",
                  "collectionID": "{{ vars.item.id }}",
                  "create_pb_id": "cc47ea13-5f9b-409e-9a50-3c80bd008140",
                  "file_response": false
                },
                "version": "1.0.0",
                "for_each": {
                  "item": "{{vars.steps.Get_All_Collections.data.collections}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "connector": "anomali-limo-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "647305cc-6a01-42cd-b9b3-f2dc287e7205",
              "id": 4971
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/0cfd2cff-194a-4049-9106-03bf98e15c3a",
              "sourceStep": "/api/3/workflow_steps/99b0d430-0dfe-426e-af5a-f726d0d25120",
              "label": null,
              "isExecuted": false,
              "uuid": "28a2974c-54bb-489a-8d6a-d9f16a5728de"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/1339cda3-f5b8-4b98-b5ec-1020aea1b46f",
              "sourceStep": "/api/3/workflow_steps/0cfd2cff-194a-4049-9106-03bf98e15c3a",
              "label": null,
              "isExecuted": false,
              "uuid": "5ea5e94e-fc9e-44e1-8353-d50e9322a7a6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value from Response",
              "targetStep": "/api/3/workflow_steps/5333a1e5-fbf3-4877-ac8d-16245e7cb47c",
              "sourceStep": "/api/3/workflow_steps/1339cda3-f5b8-4b98-b5ec-1020aea1b46f",
              "label": null,
              "isExecuted": false,
              "uuid": "72d6d791-b283-4271-9f08-3951e6342553"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value from Response -> Get All Collections",
              "targetStep": "/api/3/workflow_steps/0de3f730-3333-48a6-b1ac-d7cf2967c5fc",
              "sourceStep": "/api/3/workflow_steps/5333a1e5-fbf3-4877-ac8d-16245e7cb47c",
              "label": null,
              "isExecuted": false,
              "uuid": "b05615ed-3c77-4625-a9e3-885cb963bba4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch and Create -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/4e0f6122-d74f-44f4-bbc9-2768ba1fe041",
              "sourceStep": "/api/3/workflow_steps/647305cc-6a01-42cd-b9b3-f2dc287e7205",
              "label": null,
              "isExecuted": false,
              "uuid": "e2d9cc4d-b0c0-40cd-8f3a-12e7ab12c87f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Collections -> Fetch and Create",
              "targetStep": "/api/3/workflow_steps/647305cc-6a01-42cd-b9b3-f2dc287e7205",
              "sourceStep": "/api/3/workflow_steps/0de3f730-3333-48a6-b1ac-d7cf2967c5fc",
              "label": null,
              "isExecuted": false,
              "uuid": "3f788245-9187-4a65-8be2-f205d0ce7508"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "379b1d3a-4f2f-47dd-876d-0f24431f0c58",
          "recordTags": [
            "dataingestion",
            "ingest",
            "anomali-limo-feed"
          ],
          "id": 1202,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.973716,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638363973.504947,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Object By Object ID",
          "aliasName": null,
          "tag": "#Anomali Limo Intel Feed",
          "description": "Returns general information for the specific object of a collection.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7818ead0-d859-4e94-918b-af1fb9334781",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "3e36ab76-d307-40c1-b67b-1409558c453b",
                "title": "Anomali Limo Intel Feed: Get Object By Object ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7818ead0-d859-4e94-918b-af1fb9334781",
              "id": 4972
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Object By Object ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Intel Feed",
                "config": "''",
                "params": {
                  "objectID": "",
                  "collectionID": ""
                },
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_objects_by_object_id",
                "operationTitle": "Get Object By Object ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e7e6e64d-dfbb-4557-8ec9-58625f008663",
              "id": 4973
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Object By Object ID",
              "targetStep": "/api/3/workflow_steps/e7e6e64d-dfbb-4557-8ec9-58625f008663",
              "sourceStep": "/api/3/workflow_steps/7818ead0-d859-4e94-918b-af1fb9334781",
              "label": null,
              "isExecuted": false,
              "uuid": "a8d289b8-2828-4dbb-bd7b-8ff4bd1f2696"
            }
          ],
          "priority": null,
          "uuid": "84bac1d2-0a9e-4338-a90c-d5015bc911a6",
          "recordTags": [],
          "id": 1203,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.978937,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1638342537.978937,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get API Root Information",
          "aliasName": null,
          "tag": "#Anomali Limo Intel Feed",
          "description": "Returns information contains title, description, TAXII versions and maximum size of the content body for the specified TAXII server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2609692b-f88c-412e-9579-91c5fb01e91a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "c257fb69-00e5-4024-a8a3-58edefee88ad",
                "title": "Anomali Limo Intel Feed: Get API Root Information",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "2609692b-f88c-412e-9579-91c5fb01e91a",
              "id": 4974
            },
            {
              "@type": "WorkflowStep",
              "name": "Get API Root Information",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Intel Feed",
                "config": "''",
                "params": [],
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_api_root_information",
                "operationTitle": "Get API Root Information",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "5ec2435a-4200-4a41-9595-ac02baedfdc2",
              "id": 4975
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get API Root Information",
              "targetStep": "/api/3/workflow_steps/5ec2435a-4200-4a41-9595-ac02baedfdc2",
              "sourceStep": "/api/3/workflow_steps/2609692b-f88c-412e-9579-91c5fb01e91a",
              "label": null,
              "isExecuted": false,
              "uuid": "83c3b1b1-d4e1-4aea-b55e-cb34edff1478"
            }
          ],
          "priority": null,
          "uuid": "a40364d3-b465-4244-886d-60e2013aa931",
          "recordTags": [],
          "id": 1204,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.980142,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1638342537.980142,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Objects By Collection ID",
          "aliasName": null,
          "tag": "#Anomali Limo Intel Feed",
          "description": "Retrieve all available objects in a Collection.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a864a97f-e5fc-4e9e-b82f-d7807100876c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "8e8ed7b4-c3a7-4d7b-9a45-4b1a550fb75b",
                "title": "Anomali Limo Intel Feed: Get Objects By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "a864a97f-e5fc-4e9e-b82f-d7807100876c",
              "id": 4976
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Objects By Collection ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Intel Feed",
                "config": "''",
                "params": {
                  "added_after": "",
                  "collectionID": "",
                  "file_response": true,
                  "full_feed_fetch": ""
                },
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "42032aa7-46ab-4c33-9577-7c53f6ad6658",
              "id": 4977
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Objects By Collection ID",
              "targetStep": "/api/3/workflow_steps/42032aa7-46ab-4c33-9577-7c53f6ad6658",
              "sourceStep": "/api/3/workflow_steps/a864a97f-e5fc-4e9e-b82f-d7807100876c",
              "label": null,
              "isExecuted": false,
              "uuid": "e9a1142d-d15f-46d3-8634-0278c7179e51"
            }
          ],
          "priority": null,
          "uuid": "a481d5fe-8bfe-43f8-a3df-f34c2261b8b0",
          "recordTags": [],
          "id": 1205,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.981321,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1638342537.981321,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Manifest By Collection ID",
          "aliasName": null,
          "tag": "#Anomali Limo Intel Feed",
          "description": "Returns manifest information about all available objects.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/84494f18-161d-4056-9d52-19d512846fbe",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "78b427b9-2069-4d33-9bf5-493f100791f6",
                "title": "Anomali Limo Intel Feed: Get Manifest By Collection ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "84494f18-161d-4056-9d52-19d512846fbe",
              "id": 4978
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Manifest By Collection ID",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Intel Feed",
                "config": "''",
                "params": {
                  "added_after": "",
                  "collectionID": ""
                },
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_manifest_by_collection_id",
                "operationTitle": "Get Manifest By Collection ID",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ed0dbdc3-5478-4e67-ae85-508d14b70f39",
              "id": 4979
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Manifest By Collection ID",
              "targetStep": "/api/3/workflow_steps/ed0dbdc3-5478-4e67-ae85-508d14b70f39",
              "sourceStep": "/api/3/workflow_steps/84494f18-161d-4056-9d52-19d512846fbe",
              "label": null,
              "isExecuted": false,
              "uuid": "ebcb2eb1-d616-4a5c-be62-879212e1b524"
            }
          ],
          "priority": null,
          "uuid": "b6751be4-e080-4563-bc52-ba1e1b1e255b",
          "recordTags": [],
          "id": 1206,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.982013,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1638342537.982013,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Anomali Limo > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "ingestedData"
          ],
          "synchronous": false,
          "lastModifyDate": 1638367619,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/786477fc-5ca6-4092-bea1-f1d1db6720ae",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n  {\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true\n  }\n]"
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "786477fc-5ca6-4092-bea1-f1d1db6720ae",
              "id": 4980
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "White",
                "expiry": "",
                "tlp_map": "{\n\"Red\": {{\"TrafficLightProtocol\" | picklist(\"Red\", \"@id\")}},\n\"Amber\": {{\"TrafficLightProtocol\" | picklist(\"Amber\", \"@id\")}},\n\"Green\": {{\"TrafficLightProtocol\" | picklist(\"Green\", \"@id\")}},\n\"White\": {{\"TrafficLightProtocol\" | picklist(\"White\", \"@id\")}} \n}",
                "confidence": "50",
                "reputation": "Suspicious",
                "reputation_map": "{\n\"Good\": {{\"IndicatorReputation\" | picklist(\"Good\", \"@id\")}},\n\"Suspicious\": {{\"IndicatorReputation\" | picklist(\"Suspicious\", \"@id\")}},\n\"Malicious\": {{\"IndicatorReputation\" | picklist(\"Malicious\", \"@id\")}},\n\"No Reputation Available\": {{\"IndicatorReputation\" | picklist(\"No Reputation Available\", \"@id\")}},\n\"TBD\": {{\"IndicatorReputation\" | picklist(\"TBD\", \"@id\")}}\n}",
                "threat_intelligence_typeofindicator_map": "{\n\"domain-name\": {{\"IndicatorType\" | picklist(\"Domain\", \"@id\")}},\n\"url\": {{\"IndicatorType\" | picklist(\"URL\", \"@id\")}},\n\"network-traffic\": {{\"IndicatorType\" | picklist(\"IP Address\", \"@id\")}},\n\"ipv4-addr\": {{\"IndicatorType\" | picklist(\"IP Address\", \"@id\")}},\n\"ipv6-addr\": {{\"IndicatorType\" | picklist(\"IP Address\", \"@id\")}}\n}"
              },
              "status": null,
              "top": "160",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "1a7937f2-42e3-4ffd-af1c-4d78ca5816e0",
              "id": 4981
            },
            {
              "@type": "WorkflowStep",
              "name": "Is data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/28271ed7-7878-46d2-9129-89cc65a69d2c",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Return Sample Data"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/3b324eae-32ea-44e3-be2d-64d2ad9fbee6",
                    "step_name": "Create Record"
                  }
                ]
              },
              "status": null,
              "top": "280",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "94eb6a52-72ac-468b-839d-6738923263fa",
              "id": 4982
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params.ingestedData}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 8000
                },
                "resource": {
                  "tLP": "{% if vars.tlp %}{{ vars.tlp | resolveRange(vars.tlp_map)}}{% endif %}",
                  "type": "{% if 'pattern' in vars.item %}{{ vars.item.pattern.split(\":\")[0][1:] | resolveRange(vars.threat_intelligence_typeofindicator_map)}}{% endif %}",
                  "value": "{%if ':value' in vars.item.pattern %}{{ vars.item.pattern.split(\":value = \")[-1].split(\"]\")[0].strip()[1:-1] }}{% elif 'network-traffic' in vars.item.pattern %}{{ vars.item.pattern.split(\"network-traffic:src_ref.value =\")[-1].split(\"]\")[0].strip()[1:-1] + \":\" + vars.item.pattern.split(\"network-traffic:src_port =\")[1].split(\"AND\")[0].strip()}}{% else %}Malicious Feed{% endif %}",
                  "source": "Anomali Limo Feed",
                  "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                  "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% else %}None{% endif %}",
                  "__replace": "true",
                  "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                  "confidence": "{% if vars.confidence %}{{ vars.confidence }}{% else %}{{ vars.item.labels[2].split(\"-\")[-1] }}{% endif %}",
                  "reputation": "{% if vars.reputation %}{{ vars.reputation | resolveRange(vars.reputation_map)}}{% else %}{{ vars.item.labels[1].split(\"-\")[-1] | resolveRange(vars.reputation_map) }}{% endif %}",
                  "sourceData": "{{ vars.item }}",
                  "description": "<p>{{ vars.item.description }}</p>"
                },
                "_showJson": false,
                "collection": "/api/ingest-feeds/threat_intel_feeds",
                "__recommend": [],
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "820",
              "stepType": "/api/3/workflow_step_types/7b221880-716b-4726-a2ca-5e568d330b3e",
              "uuid": "3b324eae-32ea-44e3-be2d-64d2ad9fbee6",
              "id": 4983
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "[\n            {\n                \"created\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"created_by_ref\": \"identity--77138c7e-d23e-4966-922c-578c5793e82c\",\n                \"id\": \"indicator--8f21728d-6206-4cb7-9248-fb05c4ecfc9a\",\n                \"indicator_types\": [\n                    \"domain-watchlist\"\n                ],\n                \"modified\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"name\": \"Malicious domains\",\n                \"pattern\": \"[url:value = 'trumphujtebevrot.bit']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            },\n            {\n                \"created\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"created_by_ref\": \"identity--77138c7e-d23e-4966-922c-578c5793e82c\",\n                \"id\": \"indicator--bef17ec9-ac57-482e-9b50-32023c50a728\",\n                \"indicator_types\": [\n                    \"url-watchlist\"\n                ],\n                \"modified\": \"2021-08-19T07:09:16.546999+00:00\",\n                \"name\": \"Malicious URLs\",\n                \"pattern\": \"[url:value = 'http://dood.to/d/8djq6xhrqx31']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            },\n            {\n                \"created\": \"2021-08-19T07:06:55.546999+00:00\",\n                \"id\": \"indicator--6f159a90-752e-4e6b-bebb-28e03c62c175\",\n                \"indicator_types\": [\n                    \"malicious-activity\"\n                ],\n                \"modified\": \"2021-08-19T07:06:55.546999+00:00\",\n                \"name\": \"ZeroAccess\",\n                \"pattern\": \"[network-traffic:src_port = 16464 AND network-traffic:src_ref.value = '24.45.106.57']\",\n                \"pattern_type\": \"stix\",\n                \"spec_version\": \"2.1\",\n                \"type\": \"indicator\",\n                \"valid_from\": \"2021-08-19T00:00:00\",\n                \"valid_until\": \"2021-08-24T00:00:00\"\n            }\n]"
              },
              "status": null,
              "top": "180",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "28271ed7-7878-46d2-9129-89cc65a69d2c",
              "id": 4984
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Collection Object",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Threat Intel Feed",
                "config": "6d970bd1-c888-467d-8748-80a814fafbdf",
                "params": {
                  "limit": "",
                  "offset": "0",
                  "added_after": "",
                  "collectionID": "{{ vars.input.params.collectionID }}",
                  "file_response": false
                },
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_objects_by_collection_id",
                "operationTitle": "Get Objects By Collection ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "780",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "eff2d42b-a20b-4b7f-ab13-5a822473856f",
              "id": 4985
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy of Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params.ingestedData}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 8000
                },
                "resource": {
                  "tLP": "{% if vars.tlp %}{{ vars.tlp | resolveRange(vars.tlp_map)}}{% endif %}",
                  "type": "{% if 'pattern' in vars.item %}{{ vars.item.pattern.split(\":\")[0][1:] | resolveRange(vars.threat_intelligence_typeofindicator_map)}}{% endif %}",
                  "value": "{%if ':value' in vars.item.pattern %}{{ vars.item.pattern.split(\":value = \")[-1].split(\"]\")[0].strip()[1:-1] }}{% elif 'network-traffic' in vars.item.pattern %}{{ vars.item.pattern.split(\"network-traffic:src_ref.value =\")[-1].split(\"]\")[0].strip()[1:-1] + \":\" + vars.item.pattern.split(\"network-traffic:src_port =\")[1].split(\"AND\")[0].strip()}}{% else %}Malicious Feed{% endif %}",
                  "source": "Anomali Limo Feed",
                  "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                  "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% endif %}",
                  "__replace": "true",
                  "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                  "confidence": "{% if vars.confidence %}{{ vars.confidence }}{% endif %}",
                  "reputation": "{% if vars.reputation %}{{ vars.reputation | resolveRange(vars.reputation_map)}}{% endif %}",
                  "sourceData": "{{ vars.item }}",
                  "validUntil": "{% if vars.item.valid_until %}{{arrow.get(vars.item.valid_until).int_timestamp}}{% endif %}",
                  "description": "<p>{{ vars.item.description }}</p>"
                },
                "_showJson": false,
                "collection": "/api/ingest-feeds/threat_intel_feeds",
                "__recommend": [],
                "step_variables": []
              },
              "status": null,
              "top": "480",
              "left": "1220",
              "stepType": "/api/3/workflow_step_types/7b221880-716b-4726-a2ca-5e568d330b3e",
              "uuid": "8eb27612-9e47-4488-b57f-9400d0a822e0",
              "id": 4988
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/1a7937f2-42e3-4ffd-af1c-4d78ca5816e0",
              "sourceStep": "/api/3/workflow_steps/786477fc-5ca6-4092-bea1-f1d1db6720ae",
              "label": null,
              "isExecuted": false,
              "uuid": "2c3abef6-48d2-44fe-8a03-82ad6b5cd366"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Is data only for mapping",
              "targetStep": "/api/3/workflow_steps/94eb6a52-72ac-468b-839d-6738923263fa",
              "sourceStep": "/api/3/workflow_steps/1a7937f2-42e3-4ffd-af1c-4d78ca5816e0",
              "label": null,
              "isExecuted": false,
              "uuid": "abbe799d-66c5-4948-aa71-c52091728520"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Return Sample Data",
              "targetStep": "/api/3/workflow_steps/28271ed7-7878-46d2-9129-89cc65a69d2c",
              "sourceStep": "/api/3/workflow_steps/94eb6a52-72ac-468b-839d-6738923263fa",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "uuid": "4db1b2df-2c44-43cb-b325-4aeed4e6f74f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Create Record",
              "targetStep": "/api/3/workflow_steps/3b324eae-32ea-44e3-be2d-64d2ad9fbee6",
              "sourceStep": "/api/3/workflow_steps/94eb6a52-72ac-468b-839d-6738923263fa",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "uuid": "5abff9d1-8a23-4120-9e40-e9be5fe7ec31"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cc47ea13-5f9b-409e-9a50-3c80bd008140",
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "anomali-limo-feed"
          ],
          "id": 1207,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.982815,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638367620.054969,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Collections",
          "aliasName": null,
          "tag": "#Anomali Limo Intel Feed",
          "description": "Returns the list of public/private/shared collection resources to which the user has access.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/1df8ca1f-f282-4687-b3c8-9b9814abc7cf",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/aea76288-e624-4447-b18a-8c7c0312b40d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "74536d29-c889-46f0-a8f5-54f20ad6d35a",
                "title": "Anomali Limo Intel Feed: Get Collections",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "aea76288-e624-4447-b18a-8c7c0312b40d",
              "id": 4986
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Collections",
              "description": null,
              "arguments": {
                "name": "Anomali Limo Intel Feed",
                "config": "''",
                "params": {
                  "collectionID": ""
                },
                "version": "1.0.0",
                "connector": "anomali-limo-feed",
                "operation": "get_collections",
                "operationTitle": "Get Collections",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "80f1fed7-6756-4153-b545-fbfdcb95d4a3",
              "id": 4987
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Collections",
              "targetStep": "/api/3/workflow_steps/80f1fed7-6756-4153-b545-fbfdcb95d4a3",
              "sourceStep": "/api/3/workflow_steps/aea76288-e624-4447-b18a-8c7c0312b40d",
              "label": null,
              "isExecuted": false,
              "uuid": "7526c7f2-2667-47a5-b16f-8d12ceaea859"
            }
          ],
          "priority": null,
          "uuid": "e53603f2-b877-4e1c-8f0d-f554bf0d5ea3",
          "recordTags": [],
          "id": 1208,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1638342537.984098,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1638342537.984098,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null
        }
      ]
    }
  ],
  "exported_tags": [
    "dataingestion",
    "ingest",
    "anomali-limo-feed",
    "create",
    "fetch"
  ]
}